# 🚮 Telegram Cleaner

**Telegram Cleaner** - это простой код для очистки вашего Telegram от ненужных каналов и чатов. Программа может определять тематики каналов и их авторов,
если они указаны в BIO канала

Код поделен на две части - `analysis.py` для сбора данных о канале и `forget.py`, который либо удаляет диалоги полностью, либо переносит их в архив (это
настраивается через файл конфигурации)

Также проргамма удобна тем, что на основе определнных хештегов можно составить папки в Telegram, типа папок под ретродропы, щитпосты или новости. Список
хештегов также можно указать самому

> **Автор: [@asynco](https://t.me/asynco)**  
> **Канал: [@in_crypto_info](https://t.me/in_crypto_info)**

## 🔡 Как работает анализ

Сначала каналы проходят базовую проверку. Это данные, которые не нужно обрабатывать через LLM, они берутся напрямую из ответа от Telegram

- Базовая проверка и получаемые данные:
    - ID диалога
    - Тип диалога (личка, канал, группа, форум, бот)
    - Название диалога
    - Ссылка на диалог (`username.t.me`)
    - Дата последнего сообщения (`timestamp`)
    - Количество подписчиков
    - Являешься ли админов (`bool`)
    - Нужно ли выходить (`bool`)

Получение тематик через LLM работает только для каналов, нет смысла определять хештеги чатов или форумов. Автор же получается для всего, кроме личных
сообщений, т.к. автором там является сам юзер с которым ведется диалог

- LLM проверка и получаемые данные:
    - Автор канала (`username.t.me` или `null`)
    - Тематика канала (список от 1 до 6 хештегов)

## ⤵️ Логика is_leave

Данный параметр в таблице может быть `True` или `False` и определяет - нужно ли выходить из канала или удалять личные сообщения. Дополнительно можно
удаление поменять на архивацию

> Параметр не распространяется на **ботов**, для них маркер автоматически `False`, так как это могут быть трейдинг боты с важными данными

**Пункты проверки:**

1. Последний актив:
    - для каналов 6 мес. назад
    - для чатов/форумов 1 мес. назад
    - для личек 3 мес. назад

2. Админка:
    - на чаты/каналы где есть права админа автоматически `False`

3. Удаленный:
    - если пользователь удален, то удаляем чат с ним

4. Непрочитанные сообщения:
    - для каналов если > 20, то `True`
    - для чатов/форумов если > 1000, то `True`

## *️⃣ Получение данных аккаунта

Для начала нужно получить данные для аккаунта

> 1. Идем сюда https://my.telegram.org/apps
> 2. Указываем номер телефона
> 3. Создаем приложение
> 4. Получаем api id и api hash
> 5. Указываем их в `config.py`

## 🔠 Конфигурация

Основные параметры для запуска кода:

```ini
API_HASH = "123"        # Api Hash из пункта выше
API_ID = 123            # Api ID из пункта выше
PHONE_NUMBER = "+123"   # Номер телефона
```

Параметры для анализа отписки/архивации:

```ini
forgot_method = "arch"          # "del" - удаляем; "arch" - архивация
last_active_field = {...}       # Максимум сколько месяцев должно пройти с момента последнего поста
unread_message_field = {...}    # Лимит количства непрочитанных сообщений
```

Параметр `topic_list` можно поменять на свое усмотрение, сейчас там указаны обобщенные хештеги для каждой из области. Всего указывается от 1 до 6 наиболее
подходящих хештегов (прописано в промте)

Ниже будут промты для определения тематики и автора. Для автора промт работает отлично, но с тематиками лучше дополнительно поиграться, ибо может пихать
все теги подряд (для щитков пихает devs и тп)

Остальные параметры не трогайте. Ну и если что - `group` это чаты, а `supergroup` это форумы.

## ▶️ Запуск

Для запуска нужно [установить python](https://www.python.org/downloads/release/python-3120/). Версия должна быть >3.10, после установки нужно ввести
команду:

```bash
pip install requirements.txt
```

После этого для анализа всех каналов запускаем `analysis.py`. Когда отработает - получите базу данных

```bash
python analysis.py
```

Следующий скрипт нужен для автоматической отписки/удаления чатов или их архивации, в зависимости от выбранного режима

> **ВАЖНО!** Перед запуском нет проверки на установленный режим, сразу начнется архивация/удаление

Для запуска нужно ввести эту команду:

```bash
python forgot.py
```

По итогу у вас будет чистый Telegram и нормальное инфополе, целуйте руки

---

По всем вопросам обращайтесь в чат канала [@in_crypto_info](https://t.me/in_crypto_info)